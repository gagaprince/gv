!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){r(1)},function(e,t,r){"use strict";var n=r(2),i=r(14),a=r(18);n.initDirective();var s=n.extend({$id:null,$dom:null,$data:null,$methods:null,$tplTree:null,$vDomTree:null,$currentRenderTree:null,_renderlock:null,self:null,ctor:function(e){this.$id=e&&e.el,this.$data=e&&e.data&&e.data()||{},this.$methods=e&&e.methods||{},this.addNativeMethods(),this.mergeSelf(),this.compileData(this.$data),this.compileTplById()},addNativeMethods:function(){var e=this.nativeMethods||{};for(var t in e)this.$methods[t]=e[t]},mergeSelf:function(){this.self||(this.self={});for(var e in this.$data)this.self[e]=this.$data[e];for(var e in this.$methods)this.self[e]=this.$methods[e]},compileTplById:function(){var e=this.$id,t=this.$dom=document.getElementById(e),r=t.innerHTML;this.compileDomByTemplate(r),this.compileVDomByTplTree(),this.render()},compileDomByTemplate:function(e){this.$tplTree=i.compileTpl(e),console.log(this.$tplTree)},compileVDomByTplTree:function(){this.$vDomTree=i.parseVDom(this.$tplTree,this)},_compileObj:function(e,t,r){var n=this,i=r;Object.defineProperty(e,t,{configurable:!0,enumerable:!0,set:function(e){i=e,"object"==typeof e&&n.compileData(e),n.postRender()},get:function(){return i}})},compileData:function(e){for(var t in e){var r=e[t];"object"==typeof r&&this.compileData(r),this._compileObj(e,t,e[t])}},postRender:function(){this._renderlock&&(clearTimeout(this._renderlock),this._renderlock=null);var e=this;this._renderlock=setTimeout(function(){e.reRender()})},reRender:function(){this.compileVDomByTplTree(),this.render()},render:function(){var e=this.$vDomTree;this.$currentRenderTree?a.diffTree(this.$currentRenderTree,e):(e.setDom(this.$dom),this.$dom.innerHTML="",a.renderNormalTree(e)),this.$currentRenderTree=e},getSelf:function(){return this.self}});s.addDirective=n.addDirective,e.exports=s},function(e,t,r){"use strict";var n=r(3),i=r(4),a=r(7),s=r(8),o=r(9),c=r(10),u=r(11),l=r(12),f=r(13),h=n.extend({nativeMethods:{G_vFormEleChange:function(e){console.log(e)},G_vFormInputTextChange:function(e,t){var r=t.dom,n=r.value;this.replaceWith(this,e.trim()+'="'+n+'"')},replaceWith:function(e,t){t=" "+t.trim();return t=t.replace(/([\s\\+\-\\*\/\%\&\|\^!\*~]\s*?)([a-zA-Z_$][a-zA-Z_$0-9]*?)/g,function(e,t,r){return t+"scope."+r}),new Function("scope","return "+t)(e)}}});h.initDirective=function(){f.register(i),f.register(a),f.register(s),f.register(o),f.register(c),f.register(u),f.register(l)},h.addDirective=function(e){f.register(e)},e.exports=h},function(e,t){var r=function(){},n=/\b_super\b/;r.extend=function(e){function t(){this.ctor&&this.ctor.apply(this,arguments)}var i=this.prototype,a=Object.create(i),s={writable:!0,enumerable:!1,configurable:!0};t.prototype=a;for(var o=0,c=arguments.length;o<c;++o){var u=arguments[o];for(var l in u){var f="function"==typeof u[l],h="function"==typeof i[l],d=n.test(u[l]);f&&h&&d?(s.value=function(e,t){return function(){var r=this._super;this._super=i[e];var n=t.apply(this,arguments);return this._super=r,n}}(l,u[l]),Object.defineProperty(a,l,s)):f?(s.value=u[l],Object.defineProperty(a,l,s)):a[l]=u[l]}}return t.extend=r.extend,t},e.exports=r},function(e,t,r){"use strict";var n=r(5),i=r(6),a=i.extend({rank:n.DirectiveRank.InsertDirRank,excute:function(e,t){for(var r=e.getInner(),n=/{{(.*?)}}/gi,i=n.exec(r),a="",s=0,o=e.getScope();i;i=n.exec(r)){var c=i[1],u=i.index;a+=r.substring(s,u)+this.replaceWith(o,c),s=n.lastIndex}a+=r.substring(s),t.setDomText(a)}});a.getName=function(){return"insert"},e.exports=a},function(e,t){var r={DirectiveRank:{ElementDirRank:0,IfDirRank:1,ForDirRank:2,InsertDirRank:3,BindDirRank:5,ModelDirRank:6,OnDirRank:7}};e.exports=r},function(e,t,r){"use strict";var n=r(3),i=n.extend({express:"",rank:1e4,ctor:function(e){this.express=e},excute:function(e,t){},excuteAfter:function(e,t){},initWithExpress:function(e){this.express=e},getRank:function(){return this.rank},replaceWith:function(e,t){t=" "+t.trim();return t=t.replace(/([\s\\+\-\\*\/\%\&\|\^!\*~]\s*?)([a-zA-Z_$][a-zA-Z_$0-9]*?)/g,function(e,t,r){return t+"scope."+r}),new Function("scope","return "+t)(e)}});i.getName=function(e){return"base"},e.exports=i},function(e,t,r){"use strict";var n=r(5),i=r(6),a=i.extend({rank:n.DirectiveRank.ElementDirRank,excute:function(e,t){var r=e.getAttrMap(),n={},i="",a="";for(var s in r)if(0!=s.indexOf("g-")){var o=r[s];"id"==s?i="#"+o:"class"==s&&(a="."+o),n[s]=r[s]}var s=i+a;t.setTagName(e.getTagName()),t.setKey(s),t.setAttrMap(n)}});a.getName=function(){return"ele"},e.exports=a},function(e,t,r){"use strict";var n=r(5),i=r(6),a=i.extend({rank:n.DirectiveRank.ForDirRank,tempChildren:null,ctor:function(e){this.express=e},excute:function(e,t){if(!e.ignoreFor){var r=this.tempChildren=e.getChildren();e.clearChildren();var n=this.express,i=n.split("in"),a=i[0].trim(),s=i[1].trim(),o=e.cloneScope(),c=this.replaceWith(o,s);for(var u in c){var l=c[u],o=e.cloneScope();o[a]=l;var f=e.clone();f.setScope(o),f.addChildren(r),f.ignoreFor=!0,e.addChild(f)}}},excuteAfter:function(e,t){e.ignoreFor||(e.clearChildren(),e.addChildren(this.tempChildren),this.tempChildren=null)}});a.getName=function(){return"for"},e.exports=a},function(e,t,r){"use strict";var n=r(5),i=r(6),a=i.extend({rank:n.DirectiveRank.IfDirRank,tempChildren:null,ctor:function(e){this.express=e},excute:function(e,t){var r=e.getScope();this.replaceWith(r,this.express)||(this.tempChildren=e.getChildren(),e.clearChildren())},excuteAfter:function(e,t){this.tempChildren&&(e.addChildren(this.tempChildren),this.tempChildren=null)}});a.getName=function(){return"if"},e.exports=a},function(e,t,r){"use strict";var n=r(5),i=r(6),a=i.extend({rank:n.DirectiveRank.BindDirRank,tempChildren:null,attrKey:null,ctor:function(e,t){this.express=e,this.attrKey=t},excute:function(e,t){var r=e.getScope(),n=this.replaceWith(r,this.express);t.addAttrMap(this.attrKey,n)},excuteAfter:function(e,t){}});a.getName=function(){return"bind"},e.exports=a},function(e,t,r){"use strict";var n=r(5),i=r(6),a=i.extend({rank:n.DirectiveRank.ModelDirRank,tempChildren:null,ctor:function(e){this.express=e},excute:function(e,t){if("input"==t.getTagName())switch(t.getAttrValue("type")){case"text":this.excuteWhenInputText(e,t)}},excuteWhenInputText:function(e,t){var r=(t.getTarget(),t.getTarget().getSelf()),n=this.replaceWith(r,"G_vFormInputTextChange");t.addEventLister("input",n,[this.express]);var i=this.replaceWith(r,this.express);t.setValue(i)},excuteAfter:function(e,t){}});a.getName=function(){return"model"},e.exports=a},function(e,t,r){"use strict";var n=r(5),i=r(6),a=i.extend({rank:n.DirectiveRank.OnDirRank,tempChildren:null,attrKey:null,ctor:function(e,t){this.express=e,this.attrKey=t},excute:function(e,t){var r=(t.getTarget(),t.getTarget().getSelf()),n=this.express.trim(),i=/(.*?)\((.*?)\)/gi,a=i.exec(n);if(a){var s=a[1],o=a[2],c=[];if(o)for(var u=e.getScope(),l=o.split(","),f=0;f<l.length;f++){var h=l[f],d=this.replaceWith(u,h);c.push(d)}var p=this.replaceWith(r,s);t.addEventLister(this.attrKey,p,c)}else{var p=this.replaceWith(r,this.express);t.addEventLister(this.attrKey,p)}},excuteAfter:function(e,t){}});a.getName=function(){return"on"},e.exports=a},function(e,t){"use strict";var r={directiveMap:{},register:function(e){var t=e.getName(),r=this.directiveMap;if(t in r)throw"已经存在了同名指令 请改名";r[t]=e},getMap:function(){return this.directiveMap}};e.exports=r},function(e,t,r){"use strict";var n=r(15),i=r(17),a={compileTpl:function(e){return this.parseHtmlToTplTreeNode(e)},parseHtmlToTplTreeNode:function(e){var t=new n("tplRoot");return this.treeCompile(e,t),t},treeCompile:function(e,t){for(var r=/<(\s*\/*([a-z]{1,})(\s+(.*?)=\s*\"(.*?)\"){0,}|\s*)>/gi,n=null,i=r.exec(e),a=t;i;i=r.exec(e)){if(n){var s=n,o=i.index,c=e.substring(s,o).trim();if(""!=c){var u=this.createTplTreeNodeByText(c);a.addChild(u)}}var l=i[0],f=/<\s*([a-z]{1,})\s+(((.*?)=\s*\"(.*?)\"){0,}\s*)>|<\s*([a-z]{1,})(\s*)>/gi,h=f.exec(l);if(h){var d=[];d.push(h[0]),h[1]?(d.push(h[1]),d.push(h[2])):(d.push(h[6]),d.push(h[7]));var t=this.createTplTreeNodeByArr(d);a.addChild(t),d[1].match(new RegExp("s*(img|input|area|base|br)s*","gi"))||(a=t)}else{/<\s*\/(.*?)>/gi.exec(l)&&(a=a.getParent())}n=r.lastIndex}},createTplTreeNodeByText:function(e){if(e){var t=new n;return t.setTagName("G_text"),t.setInner(e),t.parseDirective(),t}return null},createTplTreeNodeByArr:function(e){if(e){var t=new n,r=e[1],i=this.anysisAttrMap(e[2]);return t.setTagName(r),t.setAttrMap(i),t.parseDirective(),t}return null},anysisAttrMap:function(e){var t={};e=e.trim();for(var r=/(.*?)=\"(.*?)\"/gi,n=r.exec(e);n;n=r.exec(e))t[n[1].trim()]=n[2].trim()||"";return t},parseVDom:function(e,t){var r=t.$data;e.setScope(r,!0);var n=new i("vDomRoot");return n.setTarget(t),this.createVdomTreeByTpl(n,e),n},createVdomTreeByTpl:function(e,t){this.tplNodeExcuteDirBefore(e,t);for(var r=t.getChildren(),n=r[0],i=0;n;n=r[++i]){var a=this.createProVdom(e);n.setScopeIfNull(t.getScope()),this.createVdomTreeByTpl(a,n),e.addChild(a),n.clearScope()}this.tplNodeExcuteDirAfter(e,t)},tplNodeExcuteDirBefore:function(e,t){for(var r=t.directives||[],n=0;n<r.length;n++){var i=r[n];i&&i.excute(t,e)}},tplNodeExcuteDirAfter:function(e,t){for(var r=t.directives||[],n=0;n<r.length;n++){var i=r[n];i&&i.excuteAfter(t,e)}},createProVdom:function(e){var t=new i;return t.setTarget(e.getTarget()),t}};e.exports=a},function(e,t,r){"use strict";var n=r(16),i=r(13),a=n.extend({directives:null,scope:null,tagName:"",attrMap:"",innerText:"",getAttrMap:function(){return this.attrMap},setTagName:function(e){this.tagName=e},getTagName:function(){return this.tagName},setInner:function(e){this.innerText=e},getInner:function(){return this.innerText},setAttrMap:function(e){this.attrMap=e},parseDirective:function(){var e=this.attrMap,t=i.getMap(),r=[];if(this.addNormalDirectives(r),e)for(var n in e){var a=/g-([^:]{1,}):*([^:]{0,})/gi,s=a.exec(n);if(s){var o=s[1],c=t[o];if(c){var u=new c(e[n],s[2]);r.push(u)}}}if(this.innerText){var c=t.insert;if(c){var u=new c("");r.push(u)}}r=this.sortDirs(r),this.directives=r},sortDirs:function(e){return e?(e.sort(function(e,t){return e.getRank()-t.getRank()}),e):[]},addNormalDirectives:function(e){for(var t=i.getMap(),r=["ele"],n=0;n<r.length;n++){var a=r[n],s=t[a];if(s){var o=new s("");e.push(o)}}},setScope:function(e,t){this.scope=t?this.cloneObj(e,!0):e},setScopeIfNull:function(e){this.scope||(this.scope=e)},clearScope:function(){this.scope=null},getScope:function(){return this.scope},cloneScope:function(){return this.cloneObj(this.scope,!0)},cloneObj:function(e,t){if(!e)return null;var r={};for(var n in e){var i=e[n];r[n]="object"!=typeof i||t?i:this.cloneObj(i)}return r},clone:function(){var e=new a;return e.setTagName(this.tagName),e.setAttrMap(this.attrMap),e.setKey(this.key),e.directives=this.directives,e}});e.exports=a},function(e,t,r){"use strict";var n=r(3),i=n.extend({key:"",children:null,parent:null,domText:null,text:null,ctor:function(e){this.key=e||"",this.children=[]},setKey:function(e){this.key=e},getParent:function(){return this.parent},addParent:function(e){this.parent=e},addChild:function(e){this.children.push(e),e.addParent(this)},addChildren:function(e){if(e&&e.length>0)for(var t=e.length,r=0;r<t;r++){var n=e[r];this.addChild(n)}},clearChildren:function(){this.children=[]},getChildren:function(){return this.children},setDomText:function(e){-1==e.indexOf("<")&&(this.text=e),this.domText=e},getDomText:function(){return this.domText},removeFromParent:function(){var e=this.getParent();if(e)for(var t=e.getChildren(),r=t[0],n=0;r;r=t[++n])if(r==this){t.splice(n,1);break}}});e.exports=i},function(e,t,r){"use strict";var n=r(16),i=n.extend({key:"nomal",tagName:"",id:"",className:"",attrMap:null,value:"",text:"",diffFlag:"",realDom:null,gvTarget:null,eventList:null,ctor:function(e){this._super(e)},getTagName:function(){return this.tagName},setId:function(e){this.id=e||""},setKey:function(e){this.key=e},setClassName:function(e){this.className=e||""},setAttrMap:function(e){this.attrMap=e||{}},getAttrMap:function(){return this.attrMap},addAttrMap:function(e,t){var r=this.attrMap||{};r[e]=t,this.attrMap=r},getAttrValue:function(e){return(this.attrMap||{})[e]},setTagName:function(e){this.tagName=e},getDiffNode:function(){return this.diffNode},addFlag:function(e){this.diffFlag=e},resetFlag:function(){this.diffFlag=""},setDom:function(e){this.realDom=e},getDom:function(){return this.realDom},getEventList:function(){return this.eventList||[]},addEventLister:function(e,t,r){this.eventList||(this.eventList=[]),this.eventList.push({eventName:e,callback:t,args:r||[]})},unBindEvent:function(e,t){if(e){var r=e.eventName,n=e.eventCall;n&&t.removeEventListener(r,n,!1)}},unBindEvents:function(){var e=this.eventList||[],t=this.getDom();if(t)for(var r=0;r<e.length;r++){var n=e[r],i=n.eventName,a=n.callback;t.removeEventListener(i,a,!1)}},bindEvent:function(e,t){if(e){var r=e.eventName,n=e.callback,i=e.args,a=this.getTarget(),s=a.getSelf(),o=function(e){var t=this,e={dom:t,event:e};n.apply(s,i.concat(e))};t.addEventListener(r,o,!1),e.eventCall=o}},bindEvents:function(){var e=this.eventList||[],t=this.getDom();if(t)for(var r=0;r<e.length;r++){var n=e[r];this.bindEvent(n,t)}},setTarget:function(e){this.gvTarget=e},getTarget:function(){return this.gvTarget},getValue:function(){return this.value},setValue:function(e){this.value=e}});e.exports=i},function(e,t){"use strict";var r={diffTree:function(e,t){for(var r=e.getChildren()||[],n=t.getChildren()||[],i=this._parseKeyMapFromNodeList(r),a=n[0],s=0;a;a=n[++s]){var o=a.key,c=i[o]?i[o].pop():null;if(c)a.setDom(c.getDom()),this.renderModifyNode(a,c),c.addFlag("modifyOld"),this.diffTree(c,a);else{var u=a.getParent().getDom();this.renderNormalTree(a,u)}}for(var c=r[0],s=0;c;c=r[++s]){if("modifyOld"!=c.diffFlag){var u=c.getParent().getDom(),l=c.getDom();u.removeChild(l)}}},renderModifyNode:function(e,t){var r=e.getDom();this._renderModifyAttr(e,t,r),this._renderModifyText(e,t,r),this._bindModifyEvent(e,t,r)},_renderModifyAttr:function(e,t,r){var n=e.getAttrMap(),i=t.getAttrMap();for(var a in n)a in i?(n[a]!=i[a]&&r.setAttribute(a,n[a]),delete i[a]):r.setAttribute(a,n[a]);for(var a in i)r.removeAttribute(a)},_renderModifyText:function(e,t,r){e.text!=t.text&&(r.data=e.text),e.value!=t.value&&(r.value=e.value)},_bindModifyEvent:function(e,t,r){for(var n=e.getEventList(),i=t.getEventList(),a=[].concat(i),s=0;s<n.length;s++){for(var o=n[s],c=!0,u=0;u<a.length;u++){var l=a[u];if(o.eventName==l.eventName&&o.callback==l.callback){c=!1,a.splice(u,1);break}}c&&e.bindEvent(o,r)}for(var u=0;u<a.length;u++)t.unbindEvent(l,r)},_parseKeyMapFromNodeList:function(e){if(e){for(var t={},r=e.length,n=e[r-1],i=r-1;n;n=e[--i]){var a=n.key;t[a]||(t[a]=[]);t[a].push(n)}return t}return{}},renderNormalTree:function(e,t){if(t){var r=e.tagName;if("G_text"!=r){var n=document.createElement(r),i=e.attrMap;for(var a in i){var s=i[a];n.setAttribute(a,s);var o=e.text;o&&(n.innerHTML=o);var s=e.value;s&&(n.value=s)}}else var o=e.text,n=document.createTextNode(o);t.appendChild(n),t=n,e.setDom(t),e.bindEvents()}else t=e.getDom();if(t)for(var c=e.getChildren()||[],u=c[0],l=0;u;u=c[++l])this.renderNormalTree(u,t)}};e.exports=r}]);